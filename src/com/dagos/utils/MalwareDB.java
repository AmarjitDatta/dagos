package com.dagos.utils;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class MalwareDB {
  public MalwareDB() {
  }

  public boolean searchForSignature(String signature) {
    String response = null;
    try {
      Process pr = Runtime.getRuntime().exec("python dagos.py " + signature);
      BufferedReader stdInput = new BufferedReader(new InputStreamReader(pr.getInputStream()));

      response = stdInput.readLine();
      return (response != null) && response.equalsIgnoreCase("f");
    }
    catch (IOException ex) {
      System.out.println("Exception happened while parsing YARA rules: " + ex);
    }
    return false;
  }
}
