package com.dagos.utils;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
/*
import java.util.ArrayList;
import java.util.List;
*/

public class MalwareDB {
//  private List<String> signatureList = new ArrayList<>();

  public MalwareDB() {
//    signatureList.add("virus.txt");
//    signatureList.add("trojan.txt");
//    signatureList.add("malware.txt");
  }

  public boolean searchForSignature(String signature) {
    //return signatureList.contains(signature);
    String response = "";
    try {
      Process pr = Runtime.getRuntime().exec("python dagos.py " + signature);
      BufferedReader stdInput = new BufferedReader(new InputStreamReader(pr.getInputStream()));
      response = stdInput.readLine();
      return response.equalsIgnoreCase("f");
    }
    catch (IOException ex) {
      System.out.println("Exception happened while parsing YARA rules: " + ex);
    }
    return false;
  }
}
